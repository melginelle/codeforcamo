<?php include 'mainadd.php';?>
<html>
<head>
<title></title>
</head>
<style>
body{
background-image: url("m.jpg");
background-repeat: no-repeat;
background-size: 1400px 800px;
}
</style>

<script type="text/javascript" src="jquery.min.js"></script>
<script language="javascript" type="text/javascript">
	var usr=<?php echo $username; ?>
    var timerID = null;
    var timerRunning = false;
    var now = new Date();
    var hours = 0;
    var minutes =0;
    var seconds =0;
	function windowClose() {
    window.location.reload();
}
    function stopclock ()
    {
    if(timerRunning)
    clearTimeout(timerID);
    timerRunning = false;
    }
     
    function showtime ()
    {
    if(seconds>=59)
    {
    seconds=0;
    minutes=minutes+1;
    }
    else
    {
    seconds=1+seconds;
    }
    if(minutes>=59)
    {
    minutes=0;
    hours=hours+1;
    }
	if(seconds==30)
	{
	seconds=0;
	window.alert("YOURE LATE!!! THE ZOMBIES HAVE GOT TO YOU!" );
	}
    var timeValue =zeroPad(hours,2)+":"+zeroPad(minutes,2)+":"+zeroPad(seconds,2);
    document.getElementById("timeDisplay").innerHTML=timeValue;
    timerID = setTimeout("showtime()",1000);
    timerRunning = true;
    }
    function startclock()
    {
        stopclock();
        showtime();
    }
    // End â€“>
    function zeroPad(num,count)
    {
    var numZeropad = num + '';
    while(numZeropad.length < count) {
    numZeropad = "0" + numZeropad;
    }
    return numZeropad;
    }
        </script>
		
        <script type="text/javascript" src="jquery.min.js"></script>
    
    </head>
	
	
	
	
<body onload="startclock();">
	<div id="refresh"></div>
       <h2 style="color: #000000; margin: left;">
								TIME ELAPSED:: <span id="timeDisplay"></span>
								

<canvas id="c1" width="1330" height="485" style="border: 2px solid black"> </canvas>
<h2 id="status"></h2>
<canvas id="c2" width="660" height="135" style="border: 2px solid black"> </canvas>
<canvas id="c3" width="660" height="135" style="border: 2px solid black"> </canvas>
<script>
var score=0;
var c1=0;
var c2=0;
var c3=0;
var c4=0;
var c5=0;
var c6=0;
var c7=0;
var objects=0;


var img = new Image();
img.onload = function() {
    var ctx = document.getElementById('c1').getContext('2d');
    ctx.drawImage(img, 0, 0, 1330, 490);	
}
img.src = 'lvl 4.jpg';



 var ctx1 = document.getElementById('c2').getContext('2d');
  var ctx2 = document.getElementById('c3').getContext('2d');
 ctx2.save();
 ctx2.font = "900 20px Georgia";
 ctx2.fillText("Score: "+score, 20, 50);

 


ctx1.font = "900 20px Georgia";
ctx1.fillText("WOODEN PLANKS", 20, 50);

ctx1.font = "900 20px Georgia";
ctx1.fillText("ROPE", 280, 50);

ctx1.font = "900 20px Georgia";
ctx1.fillText("SAW", 390, 50);

ctx1.font = "900 20px Georgia";
ctx1.fillText("PIRATE FLAG", 270, 120);

ctx1.font = "900 20px Georgia";
ctx1.fillText("PAPER PIECE", 20, 120);

ctx1.font = "900 20px Georgia";
ctx1.fillText("OARS", 490, 50);

ctx1.font = "900 20px Georgia";
ctx1.fillText("MATCH BOX", 490, 120);





//WOODEN PLANKS
ctx1.fillStyle = 'rgba(255,0,0,.01)';
ctx1.fillRect(10,20,210,50);

//ROPE
ctx1.fillStyle = 'rgba(0,255,0,.01)'; 
ctx1.fillRect(250,20,130,50);

//SAW
ctx1.fillStyle = 'rgba(0,255,0,.01)';
ctx1.fillRect(390,20,80,50);

//OARS
ctx1.fillStyle = 'rgba(0,255,0,.01)';
ctx1.fillRect(490,20,80,50);


//PAPER PIECE
ctx1.fillStyle = 'rgba(0,255,0,.01)';
ctx1.fillRect(20,80,165,50);


//PIRATE FLAG
ctx1.fillStyle = 'rgba(0,255,0,.01)';
ctx1.fillRect(260,80,165,50);




//MATCH BOX
ctx1.fillStyle = 'rgba(255,0,0,.01)';
ctx1.fillRect(465,80,165,90);





ctx2.fillStyle = 'rgba(0,0,0,.01)';
ctx2.fillRect(10,20,170,50);




function initCanvas(){
	var ctx = document.getElementById('c1').getContext('2d');
	
	ctx.canvas.addEventListener('mousedown', function(event) {
    var mX= event.pageX - ctx.canvas.offsetLeft;
	var mY= event.pageY - ctx.canvas.offsetTop;
	
	for(var i = 0; i < buildings.length; i++){
		var b = buildings[i];
		if(mX >= b.x && mX < b.x+b.w && mY >= b.y && mY < b.y+b.h){
		
        document.getElementById('status').innerHTML = "You found the "+b.id;
			if(b.id=="WOODEN PLANKS")
			{
			if(c1 == 0)
			{
			score=score+20;
			c1=c1+1;
			objects=objects+1;
			}
			ctx1.clearRect(10,20,210,50);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);
			} 
			
            else if(b.id=="ROPE")
			{
			if(c2 == 0)
			{
			score=score+20;
			c2=c2+1;
			objects=objects+1;
			}
			
			ctx1.clearRect(250,20,130,50);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);

			} 

			else if(b.id=="SAW")
			{
			if(c3 == 0)
			{
			score=score+20;
			c3=c3+1;
			objects=objects+1;
			}
			ctx1.clearRect(390,20,80,50);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);
			} 
			
			else if(b.id=="OARS")
			{
			if(c4 == 0)
			{
			score=score+20;
			c4=c4+1;
			objects=objects+1;
			}
			ctx1.clearRect(490,20,80,50);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);
		    } 

			else if(b.id=="PAPER PIECE")
			{
			if(c5 == 0)
			{
			score=score+20;
			c5=c5+1;
			objects=objects+1;
			}
			ctx1.clearRect(20,80,165,50);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);
			}
			


			else if(b.id=="PIRATE FLAG")
			{
			if(c6 == 0)
			{
			score=score+30;
			c6=c6+1;
			objects=objects+1;
			}
			
			ctx1.clearRect(260,80,165,50);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);
			} 
			
			
			else if(b.id=="MATCH BOX")
			{
			if(c7 == 0)
			{
			score=score+20;
			c7=c7+1;
			objects=objects+1;
			}
			
			ctx1.clearRect(465,80,165,90);
			ctx2.clearRect(10,20,170,50);
			ctx2.restore();
			ctx2.font = "900 20px Georgia";
			ctx2.fillText("Score: "+score, 20, 50);
			} 
			
		}
		
		if(objects == 7)
		{
		var end=getTime();/////////
		    var dif=end-start;/////////
			var ajaxdata = "score="+score+"&usr="+username+"&time"+dif;//////
			
			objects = 0;
			alert(ajaxdata);
			$.ajax({
	    		url: "r4chk.php",
	    		type: "POST",
	    		data: ajaxdata,
	    		success: function(data){
	    			//alert(data); //use to debug
	        		$('#refresh').load("r4chk.php");
	        		window.location.href='level5.html';
	    		}
			});
			
		}
		
		
	}
	});
	
	var buildings = [ {"id":"WOODEN PLANKS","x":320,"y":140,"w":40,"h":30,"bg":"magenta"}, 
					  {"id":"ROPE","x":182,"y":280,"w":125,"h":40,"bg":"green"},
					  {"id":"SAW","x":220,"y":380,"w":78,"h":120,"bg":"yellow"},
					  {"id":"OARS","x":1130,"y":240,"w":100,"h":40,"bg":"BLUE"},
					  {"id":"PAPER PIECE","x":580,"y":350,"w":80,"h":40,"bg":"RED"},										  					 
                      {"id":"PIRATE FLAG","x":1140,"y":30,"w":70 ,"h":50,"bg":"ORANGE"},
					  {"id":"MATCH BOX","x":220,"y":320,"w":120,"h":40,"bg":"BLACK"}




	];
	
		
	
	
	for(var i = 0; i < buildings.length; i++){
		var b = buildings[i];
		ctx.fillStyle = b.bg;
		ctx.globalAlpha=0.01;

		ctx.fillRect(b.x,b.y,b.w,b.h);
		
		

		
		

	}
}

window.addEventListener('load', function(event) {
    initCanvas();
});
</script>
</body>
</html>



